<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>multiverse</title>
<link>https://amenalahassa.github.io/amenalahassa/</link>
<atom:link href="https://amenalahassa.github.io/amenalahassa/index.xml" rel="self" type="application/rss+xml"/>
<description>A small space in the vast universe of the Internet where I share the ideas and knowledge I&#39;ve gained on my journey into AI and software development.</description>
<generator>quarto-1.5.37</generator>
<lastBuildDate>Fri, 04 Oct 2024 00:00:00 GMT</lastBuildDate>
<item>
  <title>What I Learned from Calf Face ğŸ˜Š</title>
  <link>https://amenalahassa.github.io/amenalahassa/posts/lessons_from_calf_face.html</link>
  <description><![CDATA[ 




<section id="small-data-big-dreams" class="level2">
<h2 class="anchored" data-anchor-id="small-data-big-dreams">Small Data, Big Dreams</h2>
<p>Alright, letâ€™s be realâ€”when we started, we had a <em>tiny</em> data problem. Weâ€™re talking less than 200 images of calf faces (yep, calf faces!). And trust me, thatâ€™s nowhere near enough if we want to build a robust detection model. ğŸ®</p>
<p>But no worries, we had a plan! First, we took YOLOv8 and fine-tuned it with some clever data augmentation. We went from a measly 178 images to a whopping 890â€”thanks to a combo of <strong>GaussianBlur</strong>, <strong>MedianBlur</strong>, <strong>Sharpen</strong>, <strong>Flip</strong>, and good olâ€™ <strong>rotation</strong> (between 10 to 20 degrees, nothing too wild).</p>
<p>Now, the goal was to keep the transformations realistic. No crazy color changes or outlandish rotations that might produce data that doesnâ€™t even exist in the real worldâ€”because thatâ€™s how you end up with a model that thinks cows fly. ğŸ„âœˆï¸</p>
<p>And guess what? After this magic data expansion, we saw a small bump in mAP50 (mean Average Precision) and other YOLO metrics. We went from 0.803 with basic data augmentation of YoloV8 to 0.891 on the mAP score after 10 epochs. ğŸ“ˆ</p>
<p>Hereâ€™s a quick table showing the before and after, because data geeks love tables:</p>
<table class="table">
<thead>
<tr class="header">
<th>Metric</th>
<th>Before</th>
<th>After</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>mAP50</td>
<td>0.803</td>
<td>0.891</td>
</tr>
<tr class="even">
<td>mAP50-90</td>
<td>0.503</td>
<td>0.502</td>
</tr>
<tr class="odd">
<td>Precision</td>
<td>0.992</td>
<td>1</td>
</tr>
<tr class="even">
<td>Recall</td>
<td>0.778</td>
<td>0.769</td>
</tr>
</tbody>
</table>
<p>Now, before anyone screams â€œOverfitting!â€â€”hold up. Yes, the boost in performance might make it seem like thatâ€™s whatâ€™s happening, but weâ€™re confident thatâ€™s not the case. Why? Because the video data we plan to use for detection closely resembles the training data. In other words, the modelâ€™s doing exactly what we need it to do: detect calves in environments that are super similar to the ones itâ€™s been trained on. ğŸ¯</p>
<p>Oh, and by the wayâ€”the metrics you see in that table? Those arenâ€™t based on the augmented data. Nope! Theyâ€™re from a subset of the original 175 images, which we held back specifically as our test set. So, the numbers here reflect real, unaltered images, giving us a more honest assessment of the modelâ€™s performance. ğŸ’ª</p>
</section>
<section id="choosing-the-right-model-training-where-things-get-real" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="choosing-the-right-model-training-where-things-get-real">Choosing the Right Model &amp; Training: Where Things Get Real ğŸ¯</h2>
<p>Okay, so once we had the data sorted, it was time to pick the right modelâ€”and honestly, thatâ€™s where things got a little <em>complicated</em>. Not only did I need something that would crush the performance side of things, but I also needed to be able to explain <strong>why</strong> the model made the decisions it did. You know, in case anyone asks the big question: â€œWhy did your model do that?â€ ğŸ˜…</p>
<section id="the-model-line-up" class="level3">
<h3 class="anchored" data-anchor-id="the-model-line-up">The Model Line-Up ğŸ†</h3>
<p>For <strong>images</strong>, I went through a few options before landing on the right one. I tried <strong>DeepLabV3</strong>, <strong>EfficientNet</strong>, <strong>InceptionV3</strong>, and even <strong>Unet</strong> (which I ended up abandoningâ€”long story ğŸ« ). I also gave <strong>ViT</strong> and a <strong>LSTM+CNN combo</strong> a shot, but, wellâ€¦ letâ€™s just say I didnâ€™t get around to finishing that one. Too much on my plate!</p>
<p>For <strong>videos</strong>, it was another story. I experimented with <strong>TimeSformer</strong>, <strong>ViViT</strong>, and <strong>VideoMAE</strong> to handle the moving pictures. ğŸ¥</p>
</section>
<section id="cracking-the-models-decisions-interpretability-with-omnixai" class="level3">
<h3 class="anchored" data-anchor-id="cracking-the-models-decisions-interpretability-with-omnixai">Cracking the Modelâ€™s Decisions: Interpretability with OmnixAI ğŸ§ </h3>
<p>When it came to understanding why the models made specific predictions, I leaned on some awesome interpretability algorithms from OmnixAI. These tools helped me peek under the hood of the models and get a better sense of their thought process.</p>
<p>I used a mix of techniques like GradCAM, LIME, Score-CAM, and even SmoothGrad, GuidedBP, and LayerCAM to visualize what parts of the image the model was focusing on. Each one gave me a slightly different view of how the model was processing the data, which made interpreting results a whole lot easier (and way more fun to explain ğŸ˜).</p>
<p>And I also even trained <a href="https://github.com/Imageomics/INTR"><strong>INTR</strong></a>, a transformer-based model specifically designed for interpretability. âœ¨</p>
</section>
<section id="building-a-killer-dataset-split" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="building-a-killer-dataset-split">Building a Killer Dataset Split ğŸ§©</h3>
<p>Next up, I had to make sure my dataset was split in a way that would allow for a solid comparison between models. Hereâ€™s how I did it:</p>
<p>Using the YOLO model I mentioned earlier, I went through almost 1 hour of video showing calves approaching a feeder. I grabbed the 10 seconds before each calf started feeding and extracted images where their cute little faces were visible. In the end, I had <strong>1,349 videos</strong> and <strong>7,687 images</strong>, representing <strong>76 unique calves</strong>.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="https://amenalahassa.github.io/amenalahassa/posts/assets/images/paquetlab_video_dist.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">Number of videos per calf status</figcaption>
</figure>
</div>
<p>To keep things clean, I handpicked <strong>68 videos</strong> where I verified that each calf was actually approaching the feeder (with no noise), and used those videos as my <strong>test set</strong>. The images from those videos? They became my <strong>image test set</strong> (283 images in total).</p>
</section>
<section id="two-different-training-sets-why-not" class="level3">
<h3 class="anchored" data-anchor-id="two-different-training-sets-why-not">Two Different Training Sets? Why Not? ğŸ¤·â€â™‚ï¸</h3>
<p>I built two separate training sets just for fun (and science, of course):</p>
<ol type="1">
<li><strong>Full Set</strong>: This one included all the remaining images and videos, no holds barred.</li>
<li><strong>Limited Set</strong>: Hereâ€™s where things got interesting. I only used one video and two images per calf, per health statusâ€”â€œ<strong>healthy</strong>,â€ â€œ<strong>diarrhea</strong>,â€ or â€œ<strong>pneumonia</strong>.â€ My logic? Since some images were super similar (I sampled about 30 images evenly from each 10-second video), I figured the model could easily overfit. I wanted to see how it would perform with less redundant data.</li>
</ol>
<p>Yeah, itâ€™s a pretty <em>naive</em> approach, but it sped up my work and saved some headaches. Plus, even though about 40% of the data was, well, garbage ğŸ—‘ï¸, the rest of it more than made up for it. ğŸ’ª</p>
<p>I should mentioned that those calf in the test set were not in the training set, so the model never saw them before. ğŸ„</p>
</section>
<section id="pro-tip-use-mlflow" class="level3">
<h3 class="anchored" data-anchor-id="pro-tip-use-mlflow">Pro Tip: Use MLflow! ğŸ› ï¸</h3>
<p>Oh, one last thing. If youâ€™re planning on doing so much training like this, seriously, do yourself a favor and use <strong>MLflow</strong> to track your experiments. I didnâ€™t use it for this project (donâ€™t ask, it was a mess, I swear! ğŸ¤¦â€â™‚ï¸), but if I had to do it all over again, MLflow wouldâ€™ve saved me SO much time and effort. Lesson learned!</p>
</section>
</section>
<section id="results-the-good-the-bad-and-the-calves" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="results-the-good-the-bad-and-the-calves">Results: The Good, the Bad, and the Calves ğŸ„</h2>
<p>You can check out all the detailed results and model performances in the dedicated repo for this <a href="https://github.com/amenalahassa/paquetlab">project</a> (because sharing is caring, right? ğŸ“‚). But while I didnâ€™t get a chance to completely wrap up the work (classic researcher life ğŸ˜…), there are a few important highlights that are worth mentioning.</p>
<section id="the-curious-case-of-the-intr-model" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="the-curious-case-of-the-intr-model">The Curious Case of the INTR Model ğŸ¤”</h3>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="https://amenalahassa.github.io/amenalahassa/posts/assets/images/intr_teaser.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">How the INTR model works. From the original paper</figcaption>
</figure>
</div>
<p>So, letâ€™s talk about the <strong>INTR</strong> model. The original paper boasted that this model could better explain its decisions, which sounded perfect for what I needed. But after fine-tuning it on my dataset? Yeah, not quite the same result. ğŸ¤·â€â™‚ï¸</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="https://amenalahassa.github.io/amenalahassa/posts/assets/images/intr_viz.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">How the INTR performs on my dataset</figcaption>
</figure>
</div>
<p>Why? Well, hereâ€™s where the <strong>data shift</strong> kicked in. The pre-trained model had been trained on images where the object of interest was neatly placed in the center of the frame (picture-perfect). My dataset? Not so much. My calves were sometimes, all over the place, doing their own thing, and not staying center-stage. ğŸ˜¬</p>
</section>
<section id="the-same-old-background-problem" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="the-same-old-background-problem">The â€œSame Old Backgroundâ€ Problem ğŸŒ¾</h3>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="https://amenalahassa.github.io/amenalahassa/posts/assets/images/mean_face.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">Fun image of mean calf face. I used all images extracted from the videos to compute it.</figcaption>
</figure>
</div>
<p>Another issue I ran into: <strong>background consistency</strong>. Since all my training data came from the same farm, the background was pretty much always the same. So, while the model learned to perform decently well on that data, it didnâ€™t generalize well when I tested it with images from a different farm. Different farms = different environments. And as we all know, no two farms are exactly alike, right? ğŸ¡ ğŸ„</p>
<p>Itâ€™s not the modelâ€™s faultâ€”itâ€™s just how things are. If the goal is to have a model that works across various farms, we either need a ton more data from different environments, or maybe we should consider building farm-specific models. Unless, of course, we want to standardize every farm, which, letâ€™s face it, isnâ€™t going to happen. ğŸ¤·â€â™€ï¸</p>
</section>
<section id="is-the-model-actually-learning-the-right-things" class="level3">
<h3 class="anchored" data-anchor-id="is-the-model-actually-learning-the-right-things">Is the Model Actually Learning the Right Things? ğŸ¤¨</h3>
<p>Hereâ€™s the tricky part: The model performed relatively well. Butâ€”big butâ€”it could be learning patterns we donâ€™t want it to focus on. Maybe itâ€™s using the <strong>calfâ€™s face color</strong>, or maybe the <strong>background</strong> is playing a bigger role in its decision-making than weâ€™d like to admit. In short, even though the performance metrics look good on paper, Iâ€™d recommend handling them with care. ğŸ“Š</p>
</section>
<section id="words-of-wisdom-from-my-professor" class="level3">
<h3 class="anchored" data-anchor-id="words-of-wisdom-from-my-professor">Words of Wisdom from My Professor ğŸ‘¨â€ğŸ«</h3>
<p>My supervisor always says we shouldnâ€™t expect miracles from these models. After all, itâ€™s hard for even a human to just look at a calf and determine its health status purely based on appearance. Add in the fact that weâ€™re working with limited data, and yeahâ€”it was always going to be a challenge.</p>
<p>But the whole point of this project was to test, explore, and see how a deep learning approach would hold up, despite those challenges. So, while the results may not be earth-shattering, the insights weâ€™ve gained are super valuable for refining future models. ğŸ’¡</p>
</section>
</section>
<section id="have-we-answered-the-big-question-can-we-detect-calf-health-status-from-images-or-videos" class="level2">
<h2 class="anchored" data-anchor-id="have-we-answered-the-big-question-can-we-detect-calf-health-status-from-images-or-videos">Have We Answered the Big Question? Can We Detect Calf Health Status from Images or Videos? ğŸ¤”</h2>
<p>Short answer? <strong>Not yet</strong>. ğŸ›‘</p>
<p>To be honest, I think we need a better dataset to get the results weâ€™re aiming for. Thereâ€™s definitely potentialâ€”maybe we can identify new features or patterns to help detect diseases more accurately, or perhaps the model can be trained to pick up on the same cues humans use when assessing calf health. But realistically, thatâ€™s going to take a lot more work than what Iâ€™ve done so far. ğŸ„ğŸ’»</p>
<p>One major thing Iâ€™ve learned is that using pre-trained models (whether theyâ€™re foundation models or not) on real-life problems takes way more effort, data, and attention to detail than I ever expected. When you watch those flashy demos where models seem to perform flawlessly, itâ€™s easy to think, â€œI got this.â€ But in reality? The process is a bit messier, and it involves a lot more tweaking than the demo might let on. ğŸ˜…</p>
<p>Maybe I didnâ€™t make all the right decisionsâ€”choosing the best model, or even formulating the right hypothesesâ€”but hey, thatâ€™s how we learn, right? If you have thoughts, feedback, or think thereâ€™s something I missed, feel free to comment and let me know. Letâ€™s keep the conversation going and figure this out together! ğŸ¤</p>
</section>
<section id="and-thats-a-wrap" class="level2">
<h2 class="anchored" data-anchor-id="and-thats-a-wrap">And Thatâ€™s a Wrap! ğŸ¬</h2>
<p>Until next time, keep learning, keep growing, and keep exploring the world of AI. Itâ€™s a wild ride, but hey, someoneâ€™s gotta do it! ğŸš€</p>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Retour au sommet</a> ]]></description>
  <category>Work Projects</category>
  <category>Tips &amp; Tricks</category>
  <guid>https://amenalahassa.github.io/amenalahassa/posts/lessons_from_calf_face.html</guid>
  <pubDate>Fri, 04 Oct 2024 00:00:00 GMT</pubDate>
  <media:content url="https://amenalahassa.github.io/amenalahassa/posts/assets/images/intr_viz.png" medium="image" type="image/png" height="76" width="144"/>
</item>
<item>
  <title>How Much Memory Does Your Model Need on GPU? Letâ€™s Find Out!</title>
  <link>https://amenalahassa.github.io/amenalahassa/posts/model_gpu.html</link>
  <description><![CDATA[ 




<section id="a-tool-to-estimate-model-memory-usage-on-gpu" class="level1 page-columns page-full">
<h1>A Tool to Estimate Model Memory Usage on GPU</h1>
<p>Hey there, fellow developers and curious minds! ğŸ–– Ever wondered how much juice you need to run a model on your GPU? Whether youâ€™re knee-deep in code or just dipping your toes into the tech waters, the question of resources has likely crossed your mind.</p>
<section id="building-a-tool-to-estimate-gpu-memory-usage" class="level3">
<h3 class="anchored" data-anchor-id="building-a-tool-to-estimate-gpu-memory-usage">Building a Tool to Estimate GPU Memory Usage</h3>
<p>Guess what? I built a tool for that! ğŸ‰ But hold up, before you get too excitedâ€¦ it only estimates the memory required to load the model onto a GPU. Yep, just thatâ€”no more, no less. If youâ€™re itching to test it out, <a href="https://huggingface.co/spaces/konradhugging/model-gpu-estimator">hereâ€™s the link</a>.</p>
</section>
<section id="why-only-estimate-gpu-memory-for-loading" class="level3">
<h3 class="anchored" data-anchor-id="why-only-estimate-gpu-memory-for-loading">Why Only Estimate GPU Memory for Loading?</h3>
<p>You might be asking, â€œWhy just the memory for loading?â€ Good question! Itâ€™s because to really figure out how much resources a model needs to run (whether training or inference), you actually need to run it. Yep, no shortcuts here.</p>
<p>It all depends on things like the size of your input/batch, the quality of your data (low-res images vs.&nbsp;high-res by eg), and a whole bunch of other factors. ğŸ¤¯ Oh, and donâ€™t forget the extra memory needed to store activations during the forward pass and gradients during the backward pass. The bigger the model, the more resources youâ€™ll need. Itâ€™s a classic case of go big or go home!</p>
</section>
<section id="so-how-do-i-know-how-much-memory-my-model-needs" class="level3">
<h3 class="anchored" data-anchor-id="so-how-do-i-know-how-much-memory-my-model-needs">So, How Do I Know How Much Memory My Model Needs?</h3>
<p>Hereâ€™s the deal: The memory a model uses for training is not the same as it uses for inference. Training requires more memory because it needs to store activations and gradients for backpropagation. Unfortunately, thereâ€™s no one-size-fits-all rule to tell you exactly how much memory youâ€™ll need, but we can make an educated guess.</p>
<p>You can start by using my tool to get a minimum memory estimate for loading the model. To estimate training memory, a rough approach is to multiply that number by 10, but keep in mind this is just a ballpark figure. The exact factor can vary depending on your model architecture and batch size. To be safe, always test with different configurations to find the sweet spot.</p>
<p>During inference, models generally require less memory and run faster compared to training, but there are exceptions. Monitoring tools like <code>nvidia-smi</code> can help you keep track of actual GPU usage and avoid surprises. ğŸ“Š</p>
</section>
<section id="example-time" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="example-time">Example Time! ğŸ®</h3>
<p>Letâ€™s take a practical example. I want to fine-tune the Qwen 2 model (Qwen/Qwen2-0.5B-Instruct) on a GPU P100 with 16GB of memory on Kaggle. For this exemple, I was trying to fine-tune the model on a dataset of 10k samples with a batch size of 2 and a maximum of 800 tokens per input, on a NER task.</p>
<p>When I load the model onto the GPU, it takes up around 2.6GB of memory. Not too bad, right? But when I try to train the model, you see in the image below, it maxes out all the resources. ğŸš€</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="https://amenalahassa.github.io/amenalahassa/posts/assets/images/4.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">GPU Memory Usage</figcaption>
</figure>
</div>
<p>So, whatâ€™s the takeaway here? Even if your model loads fine, it might not run smoothly during training. Always keep an eye on your resources and adjust your model or batch size accordingly.</p>
</section>
<section id="v100-vs.-a100-vs.-whatever-gpu-what-difference-does-it-make" class="level3">
<h3 class="anchored" data-anchor-id="v100-vs.-a100-vs.-whatever-gpu-what-difference-does-it-make">V100 vs.&nbsp;A100 vs.&nbsp;Whatever GPU: What Difference Does It Make?</h3>
<p>So, you might be wondering, â€œDoes it really matter which GPU I use?â€ Well, the short answer is: Absolutely! ğŸï¸</p>
<p>Itâ€™s like traveling from Canada to France. You could either fly or bike. Pretty obvious which one gets you there faster, right? The same logic applies to GPUsâ€”more powerful ones will get the job done quicker, especially when running large models.</p>
<p>Letâ€™s break it down:</p>
<ul>
<li><p><strong>Powerful GPUs like the A100</strong> not only handle large models better but also have extra features, like mixed-precision training, that can reduce memory usage and speed things up. Theyâ€™re like the jet engines of the GPU worldâ€”fast, efficient, and capable of handling heavy workloads with ease.</p></li>
<li><p><strong>Older or less powerful GPUs like the V100</strong> can still do the job, but they might struggle with bigger models or more complex tasks. Itâ€™s like taking a slower flightâ€”still gets you there, but not as fast or smoothly.</p></li>
<li><p><strong>Whatever GPU you have</strong>, just remember: You need both memory and raw power to make your model run efficiently. If your GPU isnâ€™t powerful enough, your model might take longer to run or could even crash. And nobody wants that!</p></li>
</ul>
<p>So, whether youâ€™re eyeing the latest A100 or making do with what youâ€™ve got, the takeaway is clear: A more powerful GPU means faster, more efficient model runs. If you need to go deeper, you can read this <a href="https://timdettmers.com/2023/01/30/which-gpu-for-deep-learning/">article</a> too.</p>
</section>
<section id="alternatives-if-your-model-is-too-big" class="level3">
<h3 class="anchored" data-anchor-id="alternatives-if-your-model-is-too-big">Alternatives If Your Model Is Too Big</h3>
<p>Got a huge model with over a billion parameters? No worries, there are alternatives! You can try building a smaller model that uses fewer resources. Techniques like transfer learning, model quantization, or even using a smaller model altogether can help.</p>
<p>However, keep in mind that these approaches might impact accuracy. Sometimes the trade-off isnâ€™t that significant, and you can even set up safeguards for uncertain predictions, allowing the user to choose the most appropriate response. ğŸ’¡</p>
<p>Fun fact: Iâ€™m working on a tool to anonymize text before feeding it to a large language model (LLM), and I use one of these techniques to run the model directly in the browser. Check it out here!</p>
</section>
<section id="takeaways" class="level3">
<h3 class="anchored" data-anchor-id="takeaways">Takeaways</h3>
<p>Alright, letâ€™s wrap things up:</p>
<ol type="1">
<li>Estimating exact memory requirements for your model can be tricky, but my tool can give you a good starting point.</li>
<li>The more powerful your GPU, the faster and smoother your model will runâ€”so choose wisely!</li>
<li>If your model is too big, consider alternatives like downsizing or using techniques that reduce resource demands, though be mindful of potential accuracy trade-offs.</li>
</ol>
</section>
<section id="goodbye-and-thanks" class="level3">
<h3 class="anchored" data-anchor-id="goodbye-and-thanks">Goodbye and Thanks!</h3>
<p>Thanks for sticking with me through this post! I hope you found it helpful. If you have any thoughts, suggestions, or just want to say hi, feel free to reach out via email or drop an issue below. Iâ€™m always open to learning and would love to hear from you.</p>
<p>Take care, and happy coding! ğŸš€</p>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Retour au sommet</a> ]]></description>
  <category>Tips &amp; Tricks</category>
  <category>Personal Projects</category>
  <guid>https://amenalahassa.github.io/amenalahassa/posts/model_gpu.html</guid>
  <pubDate>Sat, 24 Aug 2024 00:00:00 GMT</pubDate>
  <media:content url="https://amenalahassa.github.io/amenalahassa/posts/assets/images/0_1.png" medium="image" type="image/png" height="189" width="144"/>
</item>
<item>
  <title>How I Built a Tool to Anonymize Text for LLMs (and Why You Might Need It Too!)</title>
  <link>https://amenalahassa.github.io/amenalahassa/posts/anonymizer_intro.html</link>
  <description><![CDATA[ 




<p>Hey folks! ğŸ™Œ</p>
<p>Ever find yourself using those cool new LLMs like ChatGPT for pretty much everythingâ€”whether itâ€™s writing emails, drafting cover letters, or even creating blog content (I know I do! ğŸ˜…)? Itâ€™s like having your personal assistant right there in your browser, making life so much easier. But, waitâ€¦what happens when your prompts contain personal details? ğŸ˜¬</p>
<p>You know, that awkward moment when you realize youâ€™ve shared too much in a prompt? Yeah, been there, done that. So, I figured, why not build a tool that handles this issue and keeps things private? ğŸ’¡</p>
<section id="how-i-found-myself-working-on-this" class="level2">
<h2 class="anchored" data-anchor-id="how-i-found-myself-working-on-this">How I Found Myself Working on This ğŸ› ï¸</h2>
<p>Recently, I noticed just how much Iâ€™ve been relying on LLMs for personal stuffâ€”writing emails, tweaking my CV, crafting blogs, even coding! But every time I use them, I have to manually remove or anonymize personal info in my prompts. Talk about tedious! ğŸ˜©</p>
<p>It got to a point where I was doing this so often that I thought, â€œThereâ€™s got to be a better way!â€ And so, the idea of building a tool that runs entirely offline, right in your browser, was born. ğŸš€</p>
</section>
<section id="the-idea" class="level2">
<h2 class="anchored" data-anchor-id="the-idea">The Idea ğŸ’¡</h2>
<p>Itâ€™s super simple! Just paste your text, and voilaâ€”it anonymizes it. Now, you can safely use it in your prompts without worrying about personal details leaking out. âœ¨</p>
<section id="example-time" class="level3">
<h3 class="anchored" data-anchor-id="example-time">Example Time! âœï¸</h3>
<p>Imagine youâ€™ve have to send an email to a customer about an upcoming event at your coffee shop. Hereâ€™s what it might look like:</p>
<blockquote class="blockquote">
<p>Subject: Join us for the Grand Renovation of New York - Exciting Changes Await!</p>
<p>Dear John Green,</p>
<p>We hope this email finds you well and enjoying your favorite vanilla latte large and banana muffin at our coffee shop! As a valued and loyal customer, we are thrilled to share some exciting news with you.</p>
<p>Mark your calendar for January 4, 2023, as we invite you to join us for the grand renovation of our coffee shop at New York! We are embarking on a journey to create an even better and cozier space for you to relax, indulge, and enjoy your favorite beverages and treats.</p>
<p>You have been a cherished part of our coffee shop family for an incredible 5 years, and we cannot wait to show our appreciation by unveiling a fresh, modern look that will elevate your coffee shop experience. The renovation will bring about stylish and comfortable seating areas, captivating artwork, and state-of-the-art equipment to enhance the quality of our offerings.</p>
<p>The grand reopening event promises to be a celebration filled with delightful surprises. As our special guest, you will be among the first to explore the redesigned space and sample our latest menu additions. Immerse yourself in the inviting ambiance, meet our talented baristas, and indulge in the aroma of freshly brewed coffee that is synonymous with our coffee shop. We value your opinion, John Green, and would be thrilled to hear your thoughts and feedback on our newly renovated space. As always, our commitment remains to provide you with exceptional customer service and the highest quality products that you know and love.</p>
<p>Save the date: January 4, 2023! We cannot wait to welcome you to the grand renovation of our coffee shop at New York. Together, letâ€™s embark on this exciting journey and create countless new memories over aromatic coffees and delectable treats.</p>
<p>Thank you for being an integral part of our coffee shopâ€™s success. We look forward to continuing to serve you and make your coffee experiences unforgettable.</p>
<p>Warmest regards,</p>
</blockquote>
<p>You paste it into the tool, and <em>poof</em>â€”it replaces those details with anonymous IDs. ğŸ•µï¸â€â™€ï¸</p>
<blockquote class="blockquote">
<p>Subject: Join us for the Grand Renovation of aLOCATION_524a - Exciting Changes Await!</p>
<p>Dear aPEOPLE_872a,</p>
<p>We hope this email finds you well and enjoying your favorite vanilla latte large and banana muffin at our coffee shop! As a valued and loyal customer, we are thrilled to share some exciting news with you.</p>
<p>Mark your calendar for aDATE_988a, as we invite you to join us for the grand renovation of our coffee shop at aLOCATION_524a! We are embarking on a journey to create an even better and cozier space for you to relax, indulge, and enjoy your favorite beverages and treats.</p>
<p>You have been a cherished part of our coffee shop family for an incredible 5 years, and we cannot wait to show our appreciation by unveiling a fresh, modern look that will elevate your coffee shop experience. The renovation will bring about stylish and comfortable seating areas, captivating artwork, and state-of-the-art equipment to enhance the quality of our offerings.</p>
<p>The grand reopening event promises to be a celebration filled with delightful surprises. As our special guest, you will be among the first to explore the redesigned space and sample our latest menu additions. Immerse yourself in the inviting ambiance, meet our talented baristas, and indulge in the aroma of freshly brewed coffee that is synonymous with our coffee shop. We value your opinion, aPEOPLE_872a, and would be thrilled to hear your thoughts and feedback on our newly renovated space. As always, our commitment remains to provide you with exceptional customer service and the highest quality products that you know and love.</p>
<p>Save the date: aDATE_988a! We cannot wait to welcome you to the grand renovation of our coffee shop at aLOCATION_524a. Together, letâ€™s embark on this exciting journey and create countless new memories over aromatic coffees and delectable treats.</p>
<p>Thank you for being an integral part of our coffee shopâ€™s success. We look forward to continuing to serve you and make your coffee experiences unforgettable.</p>
<p>Warmest regards,</p>
</blockquote>
<p>Then, you can use that anonymized text in your LLM prompt. Once you get the LLMâ€™s response, you paste it back into the tool, and it replaces the IDs with your original info. As simple as that! ğŸ˜</p>
</section>
</section>
<section id="how-to-try-it" class="level2">
<h2 class="anchored" data-anchor-id="how-to-try-it">How to Try It? ğŸ¤”</h2>
<p>Excited to give it a spin? You can check it out <a href="https://amenalahassa.github.io/web-anonymiser/">here</a>. Itâ€™s still a work in progress (so donâ€™t judge me too harshly! ğŸ˜œ), but the full offline version is coming soon.</p>
<p>For now, you can test it out and share your thoughts with me. Your feedback means the world! ğŸŒ</p>
</section>
<section id="next-steps" class="level2">
<h2 class="anchored" data-anchor-id="next-steps">Next Steps ğŸš€</h2>
<p>Hereâ€™s what Iâ€™ve got cooking for the future:</p>
<ul>
<li>Turning it into a browser extension that automatically catches text you paste into input boxes, helping protect your identity on the fly.</li>
<li>Extending the tool to handle PII (Personally Identifiable Information) with customizable options for what to anonymize.</li>
<li>And so much more! ğŸ‰</li>
</ul>
</section>
<section id="but-why" class="level2">
<h2 class="anchored" data-anchor-id="but-why">But Why? ğŸ¤·â€â™‚ï¸</h2>
<p>Good question! There are already some awesome tools out there, like <a href="https://www.pontus.so/blog">this one</a> and <a href="https://github.com/AI-LLM/AnonymizedGPT?tab=readme-ov-file">this GitHub repo</a>. But none of them are quite what I was looking forâ€”so I decided to share mine! ğŸ˜„</p>
<p>If youâ€™ve got any comments, feel free to reach out or open an issue. Iâ€™m all ears! ğŸ‘‚</p>
</section>
<section id="it-was-fun-and-educational" class="level2">
<h2 class="anchored" data-anchor-id="it-was-fun-and-educational">It Was Fun and Educational! ğŸ“</h2>
<p>Building this tool was such a learning experience. I dove into ONNX, WebGPU, WebAssembly, Transformer.js, Hugging Face Inference, Angular 18, and so much more. And, boy, did I learn a lot! ğŸ’»</p>
<section id="also-a-few-things-i-noticed" class="level3">
<h3 class="anchored" data-anchor-id="also-a-few-things-i-noticed">Also, a Few Things I Noticedâ€¦ ğŸ§</h3>
<ul>
<li>Running an LLM in the browser without a GPU can be <strong>super slow</strong>. ğŸ¢</li>
<li>Not all browsers support WebGPU, so thatâ€™s a challenge.</li>
<li>To run a model in the browser, you need a <strong>really light model</strong>, preferably quantized and optimized for the web (like with Olive, for example). Ideally, it should run on WebGPU for the best performance.</li>
</ul>
</section>
</section>
<section id="final-thoughts" class="level2">
<h2 class="anchored" data-anchor-id="final-thoughts">Final Thoughtsâ€¦ ğŸ‰</h2>
<p>Overall, itâ€™s been a fantastic experience. Version 2 is already in the works, so stay tuned! ğŸ˜</p>
<p>Thanks so much for reading, and donâ€™t hesitate to reach out with your thoughts.</p>
<p>Cheers! ğŸ¥‚</p>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Retour au sommet</a> ]]></description>
  <category>Tips &amp; Tricks</category>
  <category>Personal Projects</category>
  <guid>https://amenalahassa.github.io/amenalahassa/posts/anonymizer_intro.html</guid>
  <pubDate>Fri, 23 Aug 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Finally, An Introduction: The Story Behind This Blog and Whatâ€™s Next</title>
  <link>https://amenalahassa.github.io/amenalahassa/posts/for_you.html</link>
  <description><![CDATA[ 




<section id="what-happened-indeed" class="level2">
<h2 class="anchored" data-anchor-id="what-happened-indeed">What Happened Indeed? ğŸ¤”</h2>
<p>Alright, letâ€™s be real. Life happened, right? ğŸ˜… I took some time to wrap up a few things in my life and, honestly, to kickstart a new chapter. You know that feeling when you finish one thing and feel like a whole new world opens up? Yeah, thatâ€™s where Iâ€™m at! ğŸŒŸ</p>
<p>Plus, it was the end of the school session, and I needed some well-deserved downtime. Relaxing, de-stressing, and just enjoying life for a bit. But guess what? Now Iâ€™m back, energized, and ready to take on the world! ğŸŒâœ¨</p>
<p>Iâ€™ve realized how much Iâ€™ve already accomplished, and let me tell you, Iâ€™m super grateful for all of it. ğŸ™ But I also see how much more there is to do. My blog, my job, my personal life â€“ they all need my attention, and Iâ€™m ready to dive in.</p>
<p>The possibilities ahead? Endless. Iâ€™m seizing every opportunity coming my way, and I canâ€™t wait to share the journey with you! ğŸš€</p>
</section>
<section id="whats-next" class="level2">
<h2 class="anchored" data-anchor-id="whats-next">Whatâ€™s Next? ğŸ‰</h2>
<p>First off, a huge shoutout to my brothers and my family. Without them, I wouldnâ€™t be here doing what I love. You guys are the real MVPs! ğŸ’ª</p>
<p>Now, onto me. Iâ€™m committed to working on myself, becoming the best version of me. Iâ€™m just getting started on my journey, my career, my dreams â€“ and Iâ€™m 100% ready to make them a reality. Letâ€™s do this! ğŸ™Œ</p>
</section>
<section id="the-reason-behind-this-blog" class="level2">
<h2 class="anchored" data-anchor-id="the-reason-behind-this-blog">The Reason Behind This Blog ğŸ’»</h2>
<p>So, why this blog? Well, itâ€™s simple. I want to share what Iâ€™ve accomplished in my career, in AI, in software engineering â€“ and maybe some other areas too. ğŸš€</p>
<p>But hereâ€™s the thing: this isnâ€™t going to be a blog where I show you how to do things or preach about the future of AI (though, who knows, maybe a little bit of that ğŸ˜‰). Instead, itâ€™s going to be a place where I share what Iâ€™m learning, what Iâ€™m building, and who Iâ€™m building it with. And hey, Iâ€™d love to hear your thoughts, comments, and recommendations along the way. Donâ€™t hesitate! ğŸ˜Š</p>
</section>
<section id="why-now" class="level2">
<h2 class="anchored" data-anchor-id="why-now">Why Now? ğŸ¤·</h2>
<p>You know, I just realized that I never really took the time to properly introduce this blog or explain what itâ€™s all about. Better late than never, right? ğŸ˜ So, here it is! ğŸ‰</p>
</section>
<section id="how-its-built" class="level2">
<h2 class="anchored" data-anchor-id="how-its-built">How Itâ€™s Built ğŸ› ï¸</h2>
<p>For all the techies out there, Iâ€™m using Quarto, and itâ€™s deployed with GitHub Pages. I wanted to keep things simple but also have the flexibility to share code. Quartoâ€™s been perfect for that â€“ super interesting and easy to get the hang of. ğŸ‘</p>
</section>
<section id="what-else" class="level2">
<h2 class="anchored" data-anchor-id="what-else">What Else? ğŸ§</h2>
<p>Oh, and one more thing â€“ Iâ€™ve added a page to showcase all the projects Iâ€™m working on, both finished and in progress. Iâ€™ll be publishing articles explaining them, sharing why I find them interesting, and how theyâ€™re coming along. Stay tuned! ğŸš§</p>
<p>Got any comments or ideas on how I can improve? Iâ€™m all ears! ğŸ‘‚ Iâ€™ll be updating regularly on my progress and any news, so keep an eye out for more.</p>
<p>And hey, I speak French too! Je peux bien parler en franÃ§ais quâ€™en anglais, permettez-moi ce petit Ã©cart ğŸ˜‰.</p>
</section>
<section id="ok-time-to-say-goodbye" class="level2">
<h2 class="anchored" data-anchor-id="ok-time-to-say-goodbye">Ok, Time to Say Goodbye ğŸ‘‹</h2>
<p>Thatâ€™s all for now, folks! See you soon, and take care! Love you all! ğŸ’–</p>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Retour au sommet</a> ]]></description>
  <category>Personal Projects</category>
  <category>Updates</category>
  <guid>https://amenalahassa.github.io/amenalahassa/posts/for_you.html</guid>
  <pubDate>Fri, 23 Aug 2024 00:00:00 GMT</pubDate>
  <media:content url="https://amenalahassa.github.io/amenalahassa/posts/assets/images/0_0.png" medium="image" type="image/png" height="165" width="144"/>
</item>
<item>
  <title>Passer de Yolo Ã  CocoDetection, câ€™est possible !</title>
  <link>https://amenalahassa.github.io/amenalahassa/posts/dataset-converter.html</link>
  <description><![CDATA[ 




<section id="de-quoi-sagit-il" class="level1">
<h1>De quoi sâ€™agit-il ?</h1>
<p>Dans ce post, je montre comment convertir un dataset YOLO en format COCO en utilisant la bibliothÃ¨que Python <code>globox</code>, une solution pratique que jâ€™ai rÃ©cemment appliquÃ©e pour un projet de segmentation dâ€™instance. <code>globox</code> permet Ã©galement de faire lâ€™inverse, ainsi que de nombreuses autres conversions de formats de datasets. Je vous invite Ã  explorer ce package pour dÃ©couvrir toutes les possibilitÃ©s quâ€™il offre.</p>
</section>
<section id="ok-Ã§a-donne-quoi" class="level1">
<h1>Ok, Ã§a donne quoi ?</h1>
<div id="cell-4" class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>pip install globox</span>
<span id="cb1-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>pip install pycocotools</span></code></pre></div>
</details>
</div>
<div id="cell-5" class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> pathlib <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Path</span>
<span id="cb2-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> PIL <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Image</span>
<span id="cb2-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torchvision.datasets <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> CocoDetection</span>
<span id="cb2-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> globox <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> AnnotationSet</span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb2-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.patches <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> patches</span>
<span id="cb2-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span></code></pre></div>
</details>
</div>
<p>Le code ci-dessous initialise trois chemins en utilisant la bibliothÃ¨que <code>Path</code> de Python. Les chemins <code>label_path</code> et <code>image_path</code> pointent respectivement vers les dossiers contenant les Ã©tiquettes et les images du dataset YOLO. Ensuite, le chemin <code>save_file</code> est dÃ©fini pour sauvegarder le fichier de sortie au format COCO. Enfin, la commande <code>annotations = AnnotationSet.from_yolo_v7(label_path, image_folder=image_path)</code> crÃ©e un ensemble dâ€™annotations Ã  partir des Ã©tiquettes YOLO et des images associÃ©es, prÃªt Ã  Ãªtre converti au format COCO.</p>
<div id="cell-7" class="cell" data-execution="{&quot;iopub.status.busy&quot;:&quot;2024-05-31T01:59:02.484254Z&quot;,&quot;iopub.execute_input&quot;:&quot;2024-05-31T01:59:02.484793Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T01:59:36.773381Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-05-31T01:59:02.484759Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T01:59:36.772245Z&quot;}" data-trusted="true" data-execution_count="5">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">label_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Path(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/kaggle/input/medleaves-medicinal-plant-leaves-dataset/MedLeaves/MedLeaves/train/labels"</span>)</span>
<span id="cb3-2">image_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Path(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/kaggle/input/medleaves-medicinal-plant-leaves-dataset/MedLeaves/MedLeaves/train/images"</span>) </span>
<span id="cb3-3"></span>
<span id="cb3-4">save_file <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Path(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/kaggle/working/medleaves-coco.json"</span>)</span>
<span id="cb3-5"></span>
<span id="cb3-6">annotations <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AnnotationSet.from_yolo_v7(label_path, image_folder<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>image_path)</span></code></pre></div>
</div>
<p>La commande <code>annotations.show_stats()</code> est utilisÃ©e pour afficher des statistiques sur lâ€™ensemble dâ€™annotations crÃ©Ã© prÃ©cÃ©demment. Cette mÃ©thode fournit un rÃ©sumÃ© utile des donnÃ©es annotÃ©es, comme le nombre total dâ€™images, dâ€™annotations, et la distribution des catÃ©gories dâ€™objets. Cela permet de vÃ©rifier rapidement lâ€™Ã©tat et la qualitÃ© des annotations avant de procÃ©der Ã  des opÃ©rations de conversion ou dâ€™entraÃ®nement de modÃ¨les.</p>
<div id="cell-9" class="cell" data-execution="{&quot;iopub.status.busy&quot;:&quot;2024-05-31T01:59:41.476666Z&quot;,&quot;iopub.execute_input&quot;:&quot;2024-05-31T01:59:41.477084Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T01:59:41.546606Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-05-31T01:59:41.477049Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T01:59:41.545284Z&quot;}" data-trusted="true" data-execution_count="6">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">annotations.show_stats()</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-style: italic">      Database Stats      </span>
â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”“
â”ƒ<span style="font-weight: bold"> Label </span>â”ƒ<span style="font-weight: bold"> Images </span>â”ƒ<span style="font-weight: bold"> Boxes </span>â”ƒ
â”¡â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”©
â”‚ 0     â”‚    415 â”‚  2322 â”‚
â”‚ 1     â”‚    408 â”‚   498 â”‚
â”‚ 10    â”‚    416 â”‚   588 â”‚
â”‚ 11    â”‚    412 â”‚   612 â”‚
â”‚ 12    â”‚    414 â”‚  2401 â”‚
â”‚ 13    â”‚    410 â”‚   810 â”‚
â”‚ 14    â”‚    412 â”‚  2750 â”‚
â”‚ 15    â”‚    408 â”‚  1605 â”‚
â”‚ 16    â”‚    411 â”‚  2237 â”‚
â”‚ 17    â”‚    411 â”‚  2662 â”‚
â”‚ 18    â”‚    409 â”‚   682 â”‚
â”‚ 19    â”‚    413 â”‚  5032 â”‚
â”‚ 2     â”‚    414 â”‚  5830 â”‚
â”‚ 20    â”‚    405 â”‚   882 â”‚
â”‚ 21    â”‚    415 â”‚  2892 â”‚
â”‚ 22    â”‚    409 â”‚   540 â”‚
â”‚ 23    â”‚    414 â”‚  1275 â”‚
â”‚ 24    â”‚    411 â”‚   727 â”‚
â”‚ 25    â”‚    407 â”‚  4778 â”‚
â”‚ 26    â”‚    413 â”‚  1255 â”‚
â”‚ 27    â”‚    406 â”‚   997 â”‚
â”‚ 28    â”‚    411 â”‚   618 â”‚
â”‚ 29    â”‚    409 â”‚  1143 â”‚
â”‚ 3     â”‚    411 â”‚  1584 â”‚
â”‚ 4     â”‚    405 â”‚  3082 â”‚
â”‚ 5     â”‚    405 â”‚  1275 â”‚
â”‚ 6     â”‚    416 â”‚   769 â”‚
â”‚ 7     â”‚    403 â”‚   570 â”‚
â”‚ 8     â”‚    409 â”‚  1563 â”‚
â”‚ 9     â”‚    410 â”‚  2475 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚<span style="font-weight: bold"> Total </span>â”‚<span style="font-weight: bold">  12312 </span>â”‚<span style="font-weight: bold"> 54454 </span>â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
</div>
</div>
<p>Câ€™est ici que la magie Ã  lieu ! La commande <code>annotations.save_coco(save_file, auto_ids=True)</code> sauvegarde lâ€™ensemble dâ€™annotations dans un fichier au format COCO, en utilisant le chemin spÃ©cifiÃ© par <code>save_file</code>. Lâ€™option <code>auto_ids=True</code> indique que les identifiants pour les annotations et les images seront gÃ©nÃ©rÃ©s automatiquement si nÃ©cessaire.</p>
<div id="cell-11" class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">annotations.save_coco(save_file, auto_ids<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span></code></pre></div>
</div>
<p>Visualisons ensuite le rÃ©sultat, mais en chargeant les donnÃ©es au format CocoDetection. Le code ci-dessous fait cela en utilisant la classe <code>CocoDetection</code> de la bibliothÃ¨que PyTorch.</p>
<p>Le paramÃ¨tre <code>root</code> est dÃ©fini avec le chemin vers le dossier des images (<code>image_path</code>), tandis que <code>annFile</code> spÃ©cifie le chemin du fichier dâ€™annotations au format COCO (<code>save_file</code>).</p>
<p>Enfin, <code>train_data[0][0]</code> accÃ¨de Ã  la premiÃ¨re image du dataset, afin ainsi de le visualiser.</p>
<div id="cell-13" class="cell" data-execution="{&quot;iopub.status.busy&quot;:&quot;2024-05-31T02:00:43.044327Z&quot;,&quot;iopub.execute_input&quot;:&quot;2024-05-31T02:00:43.044769Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T02:00:43.221923Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-05-31T02:00:43.044735Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T02:00:43.220768Z&quot;}" data-trusted="true" data-execution_count="12">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">train_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> CocoDetection(root <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> image_path, annFile <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> save_file, transform <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>)</span>
<span id="cb6-2">train_data[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>
<figure class="figure">
<p><img src="https://amenalahassa.github.io/amenalahassa/posts/dataset-converter_files/figure-html/cell-7-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Profitons pour visualiser une image du dataset avec ses annotations (bbox) superposÃ©es sur lâ€™image.</p>
<div id="cell-15" class="cell" data-execution="{&quot;iopub.status.busy&quot;:&quot;2024-05-31T02:04:51.070855Z&quot;,&quot;iopub.execute_input&quot;:&quot;2024-05-31T02:04:51.071241Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-05-31T02:04:51.522270Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-05-31T02:04:51.071213Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-05-31T02:04:51.520708Z&quot;}" data-trusted="true" data-execution_count="15">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Obtenir la premiÃ¨re image et ses annotations</span></span>
<span id="cb7-2">image, annotations <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> train_data[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convertir l'image PIL en tableau numpy pour l'affichage</span></span>
<span id="cb7-5">image_np <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array(image)</span>
<span id="cb7-6"></span>
<span id="cb7-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># CrÃ©er un graphique</span></span>
<span id="cb7-8">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb7-9">ax.imshow(image_np)</span>
<span id="cb7-10"></span>
<span id="cb7-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tracer chaque boÃ®te englobante</span></span>
<span id="cb7-12"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> ann <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> annotations:</span>
<span id="cb7-13">    bbox <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ann[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bbox'</span>]</span>
<span id="cb7-14">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Le format de boÃ®te englobante COCO est [x, y, largeur, hauteur]</span></span>
<span id="cb7-15">    rect <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> patches.Rectangle((bbox[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], bbox[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]), bbox[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], bbox[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>], linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r'</span>, facecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>)</span>
<span id="cb7-16">    ax.add_patch(rect)</span>
<span id="cb7-17"></span>
<span id="cb7-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Afficher le graphique</span></span>
<span id="cb7-19">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://amenalahassa.github.io/amenalahassa/posts/dataset-converter_files/figure-html/cell-8-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Jâ€™espÃ¨re que cela vous sera utile. Nâ€™hÃ©sitez pas Ã  me contacter si vous avez des questions ou des recommendations. Ã€ la prochaine ! :-)</p>


</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Retour au sommet</a> ]]></description>
  <category>Tips &amp; Tricks</category>
  <category>Tutorial</category>
  <guid>https://amenalahassa.github.io/amenalahassa/posts/dataset-converter.html</guid>
  <pubDate>Thu, 30 May 2024 00:00:00 GMT</pubDate>
</item>
</channel>
</rss>
